---
import { Icon } from 'astro-icon/components';

// Asset constants from Figma
const imgLogoWide1 = "http://localhost:3845/assets/be494146a3b9256c52a443ebe0b1138fbd3142c2.svg";
---

<header class="bg-white w-full relative z-50">
  <nav class="w-full">
    <!-- Mobile Header -->
    <div class="lg:hidden flex h-16 items-center justify-between px-5 py-0 box-border">
      <!-- Logo -->
      <div class="flex items-start justify-start">
        <div class="h-9 w-[84px] overflow-clip relative">
          <img src={imgLogoWide1} alt="Constructora Carpio" class="block max-w-none size-full" />
        </div>
      </div>
      
      <!-- Mobile Menu Button -->
      <button 
        class="flex gap-2.5 items-center justify-center relative size-12"
        id="mobile-menu-toggle"
        aria-label="Abrir menú de navegación"
      >
        <Icon name="ph:list" class="w-6 h-6 text-neutral-darkest" />
      </button>
    </div>

    <!-- Desktop Header -->
    <div class="hidden lg:flex h-[72px] items-center justify-center px-16 py-0 box-border border-b border-neutral-darkest/10">
      <div class="flex items-center justify-between relative w-full max-w-container-large">
        <!-- Logo -->
        <div class="flex h-10 items-center justify-center relative w-20">
          <div class="h-9 overflow-clip relative w-[84px]">
            <img src={imgLogoWide1} alt="Constructora Carpio" class="block max-w-none size-full" />
          </div>
        </div>
        
        <!-- Desktop Navigation -->
        <div class="flex gap-8 items-center justify-center relative">
          <!-- Nav Links -->
          <nav class="flex gap-8 items-center justify-end relative">
            <a href="/" class="font-heebo font-normal text-text-regular text-neutral-darkest hover:text-forest-green transition-colors">
              Inicio
            </a>
            <a href="/quienes-somos" class="font-heebo font-normal text-text-regular text-neutral-darkest hover:text-forest-green transition-colors">
              Nosotros
            </a>
            
            <!-- Services Dropdown -->
            <div class="relative group">
              <button class="flex gap-1 items-center justify-start relative">
                <span class="font-heebo font-normal text-text-regular text-neutral-darkest group-hover:text-forest-green transition-colors">
                  Servicios
                </span>
                <Icon name="ph:caret-down" class="w-4 h-4 transition-transform duration-300 group-hover:rotate-180" />
              </button>
              <!-- Dropdown Menu -->
              <div class="absolute top-full left-0 mt-2 w-48 bg-white rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                <div class="py-2">
                  <a href="/servicios" class="block px-4 py-2 font-heebo text-neutral-darkest hover:bg-neutral-lighter/20 transition-colors">Todos los Servicios</a>
                  <a href="/servicios/construccion" class="block px-4 py-2 font-heebo text-neutral-darkest hover:bg-neutral-lighter/20 transition-colors">Construcción</a>
                  <a href="/servicios/remodelacion" class="block px-4 py-2 font-heebo text-neutral-darkest hover:bg-neutral-lighter/20 transition-colors">Remodelación</a>
                  <a href="/servicios/mantenimiento" class="block px-4 py-2 font-heebo text-neutral-darkest hover:bg-neutral-lighter/20 transition-colors">Mantenimiento</a>
                </div>
              </div>
            </div>
            
            <!-- Projects Dropdown -->
            <div class="relative group">
              <button class="flex gap-1 items-center justify-start relative">
                <span class="font-heebo font-normal text-text-regular text-neutral-darkest group-hover:text-forest-green transition-colors">
                  Proyectos
                </span>
                <Icon name="ph:caret-down" class="w-4 h-4 transition-transform duration-300 group-hover:rotate-180" />
              </button>
              <!-- Dropdown Menu -->
              <div class="absolute top-full left-0 mt-2 w-48 bg-white rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                <div class="py-2">
                  <a href="/proyectos" class="block px-4 py-2 font-heebo text-neutral-darkest hover:bg-neutral-lighter/20 transition-colors">Todos los Proyectos</a>
                  <a href="/proyecto/proyecto-residencial-moderno" class="block px-4 py-2 font-heebo text-neutral-darkest hover:bg-neutral-lighter/20 transition-colors">Proyecto Residencial</a>
                  <a href="/proyecto/centro-comercial-innovador" class="block px-4 py-2 font-heebo text-neutral-darkest hover:bg-neutral-lighter/20 transition-colors">Centro Comercial</a>
                  <a href="/proyecto/parque-recreativo-familiar" class="block px-4 py-2 font-heebo text-neutral-darkest hover:bg-neutral-lighter/20 transition-colors">Parque Recreativo</a>
                </div>
              </div>
            </div>
          </nav>
          
          <!-- Action Buttons -->
          <div class="flex gap-4 items-center justify-center relative">
            <!-- Phone Button -->
            <div class="bg-neutral-lightest box-border flex gap-2 items-center justify-center px-5 py-2 relative rounded-[100px] border-2 border-neutral-darkest shadow-[0px_2px_2px_0px_rgba(12,8,1,0.15)] hover:bg-neutral-lighter transition-colors">
              <span class="font-heebo font-medium text-text-regular text-neutral-darkest">
                0956324598
              </span>
            </div>
            
            <!-- Contact Button -->
            <a href="/contacto" class="bg-forest-green box-border flex gap-2 items-center justify-center px-5 py-2 relative rounded-[100px] border-2 border-forest-green shadow-[0px_2px_2px_0px_rgba(12,8,1,0.15)] hover:bg-green-700 transition-colors">
              <span class="font-heebo font-medium text-text-regular text-white">
                Contacto
              </span>
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Mobile Menu Overlay (Hidden by default) -->
    <div 
      id="mobile-menu" 
      class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40 opacity-0 invisible transition-all duration-300 ease-in-out"
    >
      <div class="fixed left-0 top-0 h-full w-[65%] bg-white transform -translate-x-full transition-transform duration-300 ease-in-out">
        <div class="flex flex-col h-full">
          <!-- Mobile Menu Header -->
          <div class="flex h-16 items-center justify-between px-4 py-0 border-b border-neutral-darkest">
            <img src={imgLogoWide1} alt="Constructora Carpio" class="h-8 flex-shrink-0" />
            <button 
              id="mobile-menu-close"
              class="flex items-center justify-center w-10 h-10 flex-shrink-0 ml-2"
              aria-label="Cerrar menú"
            >
              <Icon name="ph:x" class="w-5 h-5 text-neutral-darkest" />
            </button>
          </div>
        
        <!-- Mobile Menu Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
          <div class="flex-1 overflow-y-auto p-4">
            <div class="flex flex-col gap-4">
              <a 
                href="/" 
                class="font-heebo font-medium text-lg text-neutral-darkest py-3 border-b border-neutral-lighter block"
              >
                Inicio
              </a>
              <a 
                href="/quienes-somos" 
                class="font-heebo font-medium text-lg text-neutral-darkest py-3 border-b border-neutral-lighter block"
              >
                Nosotros
              </a>
              <a 
                href="/servicios" 
                class="font-heebo font-medium text-lg text-neutral-darkest py-3 border-b border-neutral-lighter block"
              >
                Servicios
              </a>
              <a 
                href="/proyectos" 
                class="font-heebo font-medium text-lg text-neutral-darkest py-3 border-b border-neutral-lighter block"
              >
                Proyectos
              </a>
            </div>
          </div>
          
          <!-- Mobile CTA - Fixed at bottom -->
          <div class="p-4 border-t border-neutral-lighter">
            <a 
              href="/contacto" 
              class="bg-forest-green text-white px-6 py-3 rounded-full font-heebo font-medium text-base w-full text-center inline-block"
            >
              Contacto
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
  const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
  const mobileMenu = document.getElementById('mobile-menu');
  const mobileMenuClose = document.getElementById('mobile-menu-close');
  const mobileMenuPanel = mobileMenu?.querySelector('div:last-child');

  mobileMenuToggle?.addEventListener('click', () => {
    mobileMenu?.classList.remove('opacity-0', 'invisible');
    mobileMenuPanel?.classList.remove('-translate-x-full');
  });

  mobileMenuClose?.addEventListener('click', () => {
    mobileMenuPanel?.classList.add('-translate-x-full');
    setTimeout(() => {
      mobileMenu?.classList.add('opacity-0', 'invisible');
    }, 300);
  });

  // Close menu when clicking on overlay
  mobileMenu?.addEventListener('click', (e) => {
    if (e.target === mobileMenu) {
      mobileMenuPanel?.classList.add('-translate-x-full');
      setTimeout(() => {
        mobileMenu?.classList.add('opacity-0', 'invisible');
      }, 300);
    }
  });
</script>