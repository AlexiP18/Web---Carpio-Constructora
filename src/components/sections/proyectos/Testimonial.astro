---
import { Icon } from "astro-icon/components";
import Button from '../../ui/Button.astro';
---

<section class="py-20 bg-gradient-to-br from-gray-50 via-white to-gray-50 relative overflow-hidden" data-aos="fade-up">
  <!-- Decorative background elements -->
  <div class="absolute top-0 left-0 w-72 h-72 bg-primary-green/5 rounded-full blur-3xl"></div>
  <div class="absolute bottom-0 right-0 w-96 h-96 bg-blue-500/5 rounded-full blur-3xl"></div>

  <div class="max-w-7xl mx-auto px-6 relative z-10">
    <!-- Section Header -->
    <div class="text-center max-w-4xl mx-auto mb-16" data-aos="fade-up" data-aos-delay="100">
      <div class="inline-flex items-center gap-2 bg-primary-green/10 backdrop-blur-sm border border-primary-green/20 rounded-full px-4 py-2 mb-6">
        <Icon name="ph:quotes" class="w-5 h-5 text-primary-green" />
        <span class="text-primary-green font-semibold text-sm uppercase tracking-wider">Testimonios</span>
      </div>
      
      <h2 class="text-4xl lg:text-6xl font-bold text-gray-900 leading-tight mb-6">
        Experiencias Reales
      </h2>
      
      <p class="text-xl text-gray-600 leading-relaxed">
        Conoce las historias de éxito de nuestros clientes satisfechos
      </p>
    </div>

    <!-- Main Testimonial Card -->
    <div class="bg-white rounded-3xl shadow-2xl border border-gray-100 relative overflow-hidden" data-aos="fade-up" data-aos-delay="200">
      <!-- Testimonial Slider Container -->
      <div class="relative">
        <!-- Testimonial Content -->
        <div id="testimonial-slider" class="flex transition-transform duration-500 ease-in-out">
          <!-- Testimonial 1 -->
          <div class="w-full flex-shrink-0 p-8 lg:p-16">
            <div class="flex flex-col items-center text-center max-w-4xl mx-auto">
              <!-- Company Logo -->
              <div class="w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-2xl flex items-center justify-center mb-8">
                <img
                  src="/images/logo-placeholder.svg"
                  alt="Company Logo"
                  class="h-10 w-auto opacity-60"
                />
              </div>
              
              <!-- Quote -->
              <blockquote class="text-2xl lg:text-4xl font-medium leading-relaxed text-gray-900 mb-8">
                "La calidad del trabajo superó nuestras expectativas. Cada detalle fue cuidadosamente considerado y ejecutado."
              </blockquote>
              
              <!-- Rating -->
              <div class="flex gap-1 mb-8">
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
              </div>
              
              <!-- Author -->
              <div class="flex flex-col items-center">
                <div class="w-16 h-16 rounded-full overflow-hidden mb-4 ring-4 ring-primary-green/20">
                  <img
                    src="/images/avatar-image.png"
                    alt="Avatar"
                    class="w-full h-full object-cover"
                  />
                </div>
                <h4 class="text-xl font-bold text-gray-900 mb-1">Juan Pérez</h4>
                <p class="text-gray-600 font-medium">Gerente, Constructora XYZ</p>
              </div>
            </div>
          </div>
          
          <!-- Testimonial 2 -->
          <div class="w-full flex-shrink-0 p-8 lg:p-16">
            <div class="flex flex-col items-center text-center max-w-4xl mx-auto">
              <!-- Company Logo -->
              <div class="w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-2xl flex items-center justify-center mb-8">
                <img
                  src="/images/logo-placeholder.svg"
                  alt="Company Logo"
                  class="h-10 w-auto opacity-60"
                />
              </div>
              
              <!-- Quote -->
              <blockquote class="text-2xl lg:text-4xl font-medium leading-relaxed text-gray-900 mb-8">
                "Profesionalismo excepcional y atención al detalle. Recomendamos sus servicios sin dudar."
              </blockquote>
              
              <!-- Rating -->
              <div class="flex gap-1 mb-8">
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
              </div>
              
              <!-- Author -->
              <div class="flex flex-col items-center">
                <div class="w-16 h-16 rounded-full overflow-hidden mb-4 ring-4 ring-primary-green/20">
                  <img
                    src="/images/avatar-image.png"
                    alt="Avatar"
                    class="w-full h-full object-cover"
                  />
                </div>
                <h4 class="text-xl font-bold text-gray-900 mb-1">María García</h4>
                <p class="text-gray-600 font-medium">Directora, Inmobiliaria ABC</p>
              </div>
            </div>
          </div>
          
          <!-- Testimonial 3 -->
          <div class="w-full flex-shrink-0 p-8 lg:p-16">
            <div class="flex flex-col items-center text-center max-w-4xl mx-auto">
              <!-- Company Logo -->
              <div class="w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-2xl flex items-center justify-center mb-8">
                <img
                  src="/images/logo-placeholder.svg"
                  alt="Company Logo"
                  class="h-10 w-auto opacity-60"
                />
              </div>
              
              <!-- Quote -->
              <blockquote class="text-2xl lg:text-4xl font-medium leading-relaxed text-gray-900 mb-8">
                "Excelente comunicación durante todo el proyecto. Entregaron exactamente lo que prometieron."
              </blockquote>
              
              <!-- Rating -->
              <div class="flex gap-1 mb-8">
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
                <Icon name="ph:star-fill" class="w-6 h-6 text-yellow-400" />
              </div>
              
              <!-- Author -->
              <div class="flex flex-col items-center">
                <div class="w-16 h-16 rounded-full overflow-hidden mb-4 ring-4 ring-primary-green/20">
                  <img
                    src="/images/avatar-image.png"
                    alt="Avatar"
                    class="w-full h-full object-cover"
                  />
                </div>
                <h4 class="text-xl font-bold text-gray-900 mb-1">Carlos López</h4>
                <p class="text-gray-600 font-medium">CEO, Desarrollo Urbano</p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Navigation Arrows -->
        <button
          id="prev-testimonial"
          class="absolute left-4 top-1/2 transform -translate-y-1/2 w-12 h-12 bg-white/90 backdrop-blur-sm hover:bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center group"
          aria-label="Testimonio anterior"
        >
          <Icon name="ph:caret-left" class="w-5 h-5 text-gray-900 group-hover:text-primary-green transition-colors" />
        </button>
        <button
          id="next-testimonial"
          class="absolute right-4 top-1/2 transform -translate-y-1/2 w-12 h-12 bg-white/90 backdrop-blur-sm hover:bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center group"
          aria-label="Siguiente testimonio"
        >
          <Icon name="ph:caret-right" class="w-5 h-5 text-gray-900 group-hover:text-primary-green transition-colors" />
        </button>
      </div>
      
      <!-- Slider Dots -->
      <div class="flex gap-3 items-center justify-center py-8">
        <button
          class="testimonial-dot w-3 h-3 rounded-full bg-primary-green w-8 transition-all duration-300"
          data-slide="0"
          aria-label="Ir al testimonio 1"
        ></button>
        <button
          class="testimonial-dot w-3 h-3 rounded-full bg-gray-300 transition-all duration-300"
          data-slide="1"
          aria-label="Ir al testimonio 2"
        ></button>
        <button
          class="testimonial-dot w-3 h-3 rounded-full bg-gray-300 transition-all duration-300"
          data-slide="2"
          aria-label="Ir al testimonio 3"
        ></button>
      </div>
    </div>

    <!-- Bottom CTA Section -->
    <div class="mt-16 text-center" data-aos="fade-up" data-aos-delay="400">
      <div class="bg-gradient-to-r from-slate-900 to-slate-800 rounded-3xl shadow-2xl p-8 lg:p-12 relative overflow-hidden">
        <!-- Decorative elements -->
        <div class="absolute inset-0">
          <div class="absolute top-0 right-0 w-40 h-40 bg-primary-green/10 rounded-full blur-3xl"></div>
          <div class="absolute bottom-0 left-0 w-32 h-32 bg-blue-500/10 rounded-full blur-2xl"></div>
        </div>

        <div class="relative z-10 max-w-3xl mx-auto">
          <div class="inline-flex items-center gap-2 bg-primary-green/20 rounded-full px-4 py-2 mb-6">
            <Icon name="ph:handshake" class="w-5 h-5 text-primary-green" />
            <span class="text-primary-green font-semibold text-sm">Únete a Nuestros Clientes</span>
          </div>
          
          <h3 class="text-3xl lg:text-4xl font-bold text-white mb-6">
            ¿Listo para crear tu historia de éxito?
          </h3>
          
          <p class="text-xl text-gray-300 mb-8 leading-relaxed">
            Forma parte de nuestra familia de clientes satisfechos y experimenta la diferencia de trabajar con verdaderos profesionales.
          </p>
          
          <div class="flex flex-col sm:flex-row gap-4 items-center justify-center">
            <Button 
              variant="primary"
              size="lg"
              iconPosition="left"
              icon="ph:rocket-launch"
              animation="hover"
              href="/contacto"
            >
              Comenzar Mi Proyecto
            </Button>
            
            <Button 
              variant="outline"
              size="lg"
              iconPosition="left"
              icon="ph:phone"
              animation="hover"
              href="/contacto"
              class="bg-transparent border-2 border-white text-white hover:bg-white hover:text-gray-900"
            >
              Hablar con un Experto
            </Button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const slider = document.getElementById('testimonial-slider');
    const prevBtn = document.getElementById('prev-testimonial');
    const nextBtn = document.getElementById('next-testimonial');
    const dots = document.querySelectorAll('.testimonial-dot');
    
    let currentSlide = 0;
    const totalSlides = 3;

    function updateSlider() {
      if (slider) {
        const translateX = -currentSlide * 100;
        slider.style.transform = `translateX(${translateX}%)`;
      }
      
      // Update dots
      dots.forEach((dot, index) => {
        if (index === currentSlide) {
          dot.classList.remove('bg-gray-300', 'w-3');
          dot.classList.add('bg-primary-green', 'w-8');
        } else {
          dot.classList.remove('bg-primary-green', 'w-8');
          dot.classList.add('bg-gray-300', 'w-3');
        }
      });
    }

    function nextSlide() {
      currentSlide = (currentSlide + 1) % totalSlides;
      updateSlider();
    }

    function prevSlide() {
      currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
      updateSlider();
    }

    // Event listeners
    nextBtn?.addEventListener('click', nextSlide);
    prevBtn?.addEventListener('click', prevSlide);

    // Dot navigation
    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => {
        currentSlide = index;
        updateSlider();
      });
    });

    // Auto-play slider every 5 seconds
    setInterval(nextSlide, 5000);

    // Touch/swipe support for mobile
    let startX = 0;
    let startY = 0;

    slider?.addEventListener('touchstart', (e) => {
      startX = e.touches[0].clientX;
      startY = e.touches[0].clientY;
    });

    slider?.addEventListener('touchend', (e) => {
      if (!startX || !startY) return;

      const endX = e.changedTouches[0].clientX;
      const endY = e.changedTouches[0].clientY;

      const diffX = startX - endX;
      const diffY = startY - endY;

      // Only trigger if horizontal swipe is greater than vertical
      if (Math.abs(diffX) > Math.abs(diffY)) {
        if (diffX > 50) {
          nextSlide();
        } else if (diffX < -50) {
          prevSlide();
        }
      }

      startX = 0;
      startY = 0;
    });
  });
</script>
